<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Login - Lab Booking</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <div class="topbar">
        <h1>Login</h1>
        <nav class="nav">
          <a href="index.html">Home</a>
          <a href="mybookings.php">My Bookings</a>
          <a href="login.html">Login</a>
        </nav>
        <div id="userInfo" class="user-info"></div>
      </div>
    </header>
    <main>
      <section class="card" style="max-width:420px;margin:20px auto;">
        <form id="loginForm" action="login.php" method="POST">
          <label for="email">Email</label>
          <input id="email" name="email" type="email" required placeholder="your@email.com" />
          <label for="password">Password</label>
          <input id="password" name="password" type= "password" required placeholder="Your password" />
          <div style="margin-top:12px;display:flex;gap:8px;justify-content:flex-end;">
            <button type="submit">Login</button>
            <a href="register.html" class="muted">Register</a>
          </div>
        </form>
      </section>
    </main>
    <!--
    <script src="app.js"></script>
    <script>
      async function tryApiLogin(email){
        try{
          const res = await fetch('http://localhost:3000/api/users/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({email})});
          if(!res.ok) return {error:true, message:await res.text()};
          const data = await res.json();
          return data;
        }catch(e){ console.error(e); return {error:true, network:true}; }
      }

      document.getElementById('loginForm').addEventListener('submit', async (e)=>{
        e.preventDefault();
        const email = document.getElementById('email').value.trim();
        if(!email) return alert('Enter your email');
        const result = await tryApiLogin(email);
        if(result && !result.error && result.user){
          bookingApp.setCurrentUser(result.user);
          return;
        }
        if(result && result.network){
          alert('Backend server is not running. Please start the server.');
          return;
        }
        alert('Login failed: ' + (result.message || 'User not found. Please register first.'));
      });
      
      document.addEventListener('DOMContentLoaded', () => {
        bookingApp.updateUserUI();
      });
    </script>
    -->
  </body>
</html>
